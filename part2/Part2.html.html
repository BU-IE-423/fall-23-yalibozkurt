<!DOCTYPE html><html><head><meta charset="utf-8"><title>IE 423: QUALITY ENGINEERING.md</title><style></style></head><body id="preview">
<h1 class="code-line" data-line-start="0" data-line-end="1"><a id="IE_423_QUALITY_ENGINEERING_0"></a>IE 423: QUALITY ENGINEERING</h1>
<h2 class="code-line" data-line-start="2" data-line-end="3"><a id="_Project_Part_2__2"></a><em>Project Part 2</em></h2>
<h2 class="code-line" data-line-start="4" data-line-end="5"><a id="Task_1_4"></a>Task 1</h2>
<p class="has-line-data" data-line-start="5" data-line-end="6">To start with, we first insert the data, combine it as a dataframe and take the related parts from it according to the timestamps. Our training data is 1 year and test data, where we implement the simulation, is 6 months. The reason for that is not to keep test data period too short, and giving the simulation enough time to have outliers or namely, signals. After that, we do linear regression and take and store the residuals to use later, calculate the correlations for every possible pair of stocks, and list them in decreasing order. The code and outputs are as follows :</p>
<pre><code class="has-line-data" data-line-start="8" data-line-end="108">library(anytime)
library(dplyr)
library(lubridate)

directory_path &lt;- &quot;/Users/ibrahimemrekoksal/Desktop/423 data2&quot;

# Get a list of all CSV files in the directory
csv_files &lt;- list.files(directory_path, pattern = &quot;\\.csv$&quot;, full.names = TRUE)

# Initialize an empty data frame to store the combined data
combined_data &lt;- data.frame()

# Loop through each CSV file and combine the data
for (file in csv_files) {
  # Read the CSV file
  current_data &lt;- read.csv(file)
  
  # Combine the data
  combined_data &lt;- bind_rows(combined_data, current_data)
}
Training_Data &lt;- combined_data %&gt;% #Data we use to form the control charts
  filter(year(timestamp)==2018)
Test_data &lt;- combined_data %&gt;% #Data we do the simulation on according to the control chart
  filter(year(timestamp) == 2019, quarter(timestamp) %in% c(1,2))

data &lt;- Test_data
data$timestamp &lt;- anytime(data$timestamp)
Training_Data$timestamp &lt;- anytime(Training_Data$timestamp)

##Linear Regression part for the Test Data
unique_stocks &lt;- unique(data$short_name)
# Create an empty list to store data frames for each stock
stock_data_list &lt;- list()
# Loop through each stock and subset the data
for (stock in unique_stocks) {
  stock_data_list[[stock]] &lt;- subset(data, short_name == stock)
}

# Access a specific stock's data using stock_data_list$stockname
akbnk_data &lt;- stock_data_list[[&quot;AKBNK&quot;]]
garanti_data &lt;- stock_data_list[[&quot;GARAN&quot;]]
merged_data &lt;- merge(akbnk_data, garanti_data, by = &quot;timestamp&quot;)
regression_model &lt;- lm(price.x ~ price.y, data = merged_data)

##Linear Regression part for the Training Data

unique_stocks_Training &lt;- unique(Training_Data$short_name)
# Create an empty list to store data frames for each stock
stock_data_list &lt;- list()
# Loop through each stock and subset the data
for (stock in unique_stocks_Training) {
  stock_data_list[[stock]] &lt;- subset(Training_Data, short_name == stock)
}

# Access a specific stock's data using stock_data_list$stockname
akbnk_data_training &lt;- stock_data_list[[&quot;AKBNK&quot;]]
garanti_data_training &lt;- stock_data_list[[&quot;GARAN&quot;]]
merged_data_training &lt;- merge(akbnk_data_training, garanti_data_training, by = &quot;timestamp&quot;)
regression_model_training &lt;- lm(price.x ~ price.y, data = merged_data_training)
residuals_training &lt;- residuals(regression_model_training)

# Create a data frame with timestamp and residuals
residual_data_training &lt;- data.frame(timestamp = merged_data_training$timestamp, residuals = residuals_training)
######
residual_data_training$timestamp &lt;- as.Date(residual_data_training$timestamp)

# Get the names of stocks
stock_names &lt;- names(stock_data_list)

# Create an empty data frame to store correlation results
correlation_results &lt;- data.frame()

# Iterate through all pairs of stocks and calculate correlation
for (i in 1:(length(stock_names)-1)) {
  for (j in (i+1):length(stock_names)) {
    stock1 &lt;- stock_data_list[[stock_names[i]]]
    stock2 &lt;- stock_data_list[[stock_names[j]]]
    
    # Merge data on the 'timestamp' column
    mrgd_data &lt;- merge(stock1, stock2, by = &quot;timestamp&quot;)
    
    # Calculate correlation
    correlation &lt;- cor(mrgd_data$price.x, mrgd_data$price.y)
    
    # Store the results in the data frame
    correlation_results &lt;- rbind(correlation_results, data.frame(
      Stock1 = stock_names[i],
      Stock2 = stock_names[j],
      Correlation = correlation
    ))
  }
}

# Filter pairs with strong correlation (you can adjust the threshold)
strong_correlations &lt;- correlation_results[order(-correlation_results$Correlation), ]

# Print the pairs with strong correlation
print(strong_correlations)

</code></pre>
<p class="has-line-data" data-line-start="108" data-line-end="112">The result of print(stong_correlations) displays pairs of stocks with their correlation values. Some notable strong correlations are as follows:<br>
ISCTR and YKBNK: 0.987<br>
ISCTR and VAKBN: 0.982<br>
AKBNK and GARAN: 0.980</p>
<p class="has-line-data" data-line-start="113" data-line-end="114">The corresponding stock prices have a strong linear relationship, as seen by the high correlation values. It is assumed that highly correlated stocks react to market movements in a similar way and trading is done based on the relative movement between the two stocks using a market neutral trading strategy. The Akbank-Garanti pair has correlation 0.98 in the year 2022, when we take the whole data, it exceeds 0.99 where Sasa-Sise pair stands in the 0.92s. We aimed for one pair to have a very high correlation and another to have a relatively lower one thus choosing these two pairs for the simulation. The reason is that when the correlation is incredibly high, trading opportunities become scarce, making it challenging to generate profits. The reason for the difference in years is due to the relative stagnation between 2018 and 2021, and significant price changes and high volatility in the market in 2022-23. The idea was to select one pair from a period of stability and another from recent years with substantial changes in prices.</p>
<p class="has-line-data" data-line-start="115" data-line-end="116">The training data spanned a period of 1 year, while the test data covered 6 months. This choice was motivated by the high variability observed in the earlier years of stock data. The intention was to capture and model the relationships during this period to inform the strategy’s decisions in the subsequent 6-month test period.</p>
<p class="has-line-data" data-line-start="117" data-line-end="118">Linear regression model was applied to the identified stock pairs to understand their relationship and the residuals and coefficients were calculated under the assumption of constant variance which indicates that the spread of residuals remains relatively consistent across the entire dataset. The ordinary least squares estimators used in linear regression models are unbiased and efficient under the assumption of constant variance. This is the basic difference between linear regression and time series analysis we make.</p>
<p class="has-line-data" data-line-start="119" data-line-end="120">After the residuals are calculated according to the linear regression model, standard deviation of the residuals were calculated which is later used to establish control limits. The violation of the constant variance assumption is evident in the higher variance observed in residuals, contributing to increased uncertainty in predictions. In this case, 2 standard deviations corresponding to the 95% confidence interval is used for the establishment of control limits. Trading signals are generated when a residual crosses one of the control limits.</p>
<p class="has-line-data" data-line-start="121" data-line-end="122">The R code that is used for obtaining the control limits and out-of-control situations is as follows:</p>
<pre><code class="has-line-data" data-line-start="123" data-line-end="150"># Create a data frame with timestamp and residuals
residuals &lt;- residuals(regression_model)
residual_data &lt;- data.frame(timestamp = merged_data$timestamp, residuals = residuals)

# Print the residual data
print(residual_data)
residual_data$timestamp &lt;- as.Date(residual_data$timestamp)

library(ggplot2)

# Calculate control limits 
upper_limit &lt;- mean(residual_data_training$residuals) + 2 * sd(residual_data_training$residuals)
lower_limit &lt;- mean(residual_data_training$residuals) - 2 * sd(residual_data_training$residuals)

ggplot(residual_data, aes(x = timestamp, y = residuals)) +
  geom_point() +
  geom_line() +
  geom_hline(yintercept = upper_limit, linetype = &quot;solid&quot;, color = &quot;red&quot;) +
  geom_hline(yintercept = lower_limit, linetype = &quot;solid&quot;, color = &quot;red&quot;) +
  ggtitle(&quot;X-bar Chart of Residuals&quot;) +
  xlab(&quot;Date&quot;) +
  ylab(&quot;Daily Average Residuals&quot;)

# Highlight points outside control limits
out_of_control &lt;- subset(residual_data, residuals &gt; upper_limit | residuals &lt; lower_limit)
print(out_of_control)
</code></pre>
<p class="has-line-data" data-line-start="150" data-line-end="151">The output of print(out_of_control) displays timestamps and corresponding residuals that fall outside the control limits. According to the control chart analysis, points outside the control limits are considered statistically significant and may indicate special causes of variation.</p>
<p class="has-line-data" data-line-start="152" data-line-end="153">For Akbank and Garanti stocks, the output is as follows:</p>
<p class="has-line-data" data-line-start="154" data-line-end="159">timestamp residuals<br>
582 2019-03-25 -0.4423424<br>
583 2019-03-25 -0.4338906<br>
584 2019-03-25 -0.4367958<br>
586 2019-03-25 -0.4395528</p>
<p class="has-line-data" data-line-start="160" data-line-end="161">On the date ‘2019-03-25’, there are residuals that deviate from the expected behavior based on the control limits. Negative residuals indicate that the actual values were lower than the predicted ones. The reasons for the small number of outliers are relatively short period, drastically high correlation and small volatility of the market.</p>
<p class="has-line-data" data-line-start="162" data-line-end="164">The dataset that was used for creating control charts does not include the actual trading data. The procedure of creating a control chart is similar to training a model or configuring parameters; trading happens on a different dataset that wasn’t used in the production of the control chart. The X bar chart including the out of control points is as follows:<br>
<img src="part2/images/images/2.jpeg" alt="control chart 1"></p>
<p class="has-line-data" data-line-start="165" data-line-end="167">After getting the outliers, we assing corresponding signals to the residual data and form control charts. In the simulation part, we check for each residual in the test data and if out of limits, we open necessary positions. If the signal is 1, that means Akbank stock price is relatively low and we open a long position for akbank and a short position for garanti with 1 unit of money. We close the positions when the residuals are in control again, our trigger is -+ standard deviation of residuals/2. After the time period is over, we get the total accumulated earning as output and related position information.<br>
The R code for simulation is as follows:</p>
<pre><code class="has-line-data" data-line-start="169" data-line-end="261"># Create a column in merged_data for residuals
merged_data$residual &lt;- residuals(regression_model)

# Signal Generation
merged_data$signal &lt;- ifelse(merged_data$residual &gt; upper_limit, -1, 
                             ifelse(merged_data$residual &lt; lower_limit, 1, 0))


# Initialization
long_position_akbnk&lt;- FALSE
short_position_akbnk&lt;- FALSE
long_position_garan &lt;- FALSE
short_position_garan &lt;- FALSE
total_earnings &lt;- 0
row_number &lt;- nrow(merged_data)
# Variables to store entry dates
entry_date_akbnk &lt;- NA
entry_date_garan &lt;- NA

# Loop through each timestamp
for (i in 2:nrow(merged_data)) {
  
  # Check for signal
  if (merged_data$signal[i - 1] == 1 &amp;&amp; !long_position_akbnk &amp;&amp; !short_position_akbnk) {
    # Open long position in AKBNK and short position in GARAN
    long_position_akbnk &lt;- TRUE
    short_position_garan &lt;- TRUE
    entry_price_akbnk &lt;- merged_data$price.x[i]
    entry_price_garan &lt;- merged_data$price.y[i]
    entry_date_akbnk &lt;- merged_data$timestamp[i]
    entry_date_garan &lt;- merged_data$timestamp[i]
    print(paste(&quot;Opened long position in AKBNK on&quot;, entry_date_akbnk))
    print(paste(&quot;Opened short position in GARAN on&quot;, entry_date_garan))
  } else if (merged_data$signal[i - 1] == -1 &amp;&amp; !long_position_akbnk &amp;&amp; !short_position_akbnk) {
    # Open long position in GARAN and short position in AKBNK
    long_position_garan &lt;- TRUE
    short_position_akbnk &lt;- TRUE
    entry_price_akbnk &lt;- merged_data$price.x[i]
    entry_price_garan &lt;- merged_data$price.y[i]
    entry_date_akbnk &lt;- merged_data$timestamp[i]
    entry_date_garan &lt;- merged_data$timestamp[i]
    print(paste(&quot;Opened long position in GARAN on&quot;, entry_date_garan))
    print(paste(&quot;Opened short position in AKBNK on&quot;, entry_date_akbnk))
  }
  
  if (long_position_akbnk) {
    # Close long AKBNK position if residual reverts to zero
    if (abs(merged_data$residual[i]) &lt; sd(residual_data_training$residuals)/2) {
      long_position_akbnk &lt;- FALSE
      earning_percentage &lt;- (merged_data$price.x[i] - entry_price_akbnk) / entry_price_akbnk
      total_earnings &lt;- total_earnings + earning_percentage
      print(paste(&quot;Closed long position in AKBNK on&quot;, merged_data$timestamp[i], &quot;with earnings:&quot;, earning_percentage))
    }
  }
  
  # Check for closing short AKBNK position
  if (short_position_akbnk) {
    # Close short AKBNK position if residual reverts to zero
    if (abs(merged_data$residual[i]) &lt; sd(residual_data_training$residuals)/2) {
      short_position_akbnk &lt;- FALSE
      earning_percentage &lt;- (entry_price_akbnk - merged_data$price.x[i]) / entry_price_akbnk
      total_earnings &lt;- total_earnings + earning_percentage
      print(paste(&quot;Closed short position in AKBNK on&quot;, merged_data$timestamp[i], &quot;with earnings:&quot;, earning_percentage))
    }
  }
  
  # Check for closing long GARAN position
  if (long_position_garan) {
    # Close long GARAN position if residual reverts to zero
    if (abs(merged_data$residual[i]) &lt; sd(residual_data_training$residuals)/2) {
      long_position_garan &lt;- FALSE
      earning_percentage &lt;- (merged_data$price.y[i] - entry_price_garan) / entry_price_garan
      total_earnings &lt;- total_earnings + earning_percentage
      print(paste(&quot;Closed long position in GARAN on&quot;, merged_data$timestamp[i], &quot;with earnings:&quot;, earning_percentage))
    }
  }
  
  # Check for closing short GARAN position
  if (short_position_garan) {
    # Close short GARAN position if residual reverts to zero
    if (abs(merged_data$residual[i]) &lt; sd(residual_data_training$residuals)/2) {
      short_position_garan &lt;- FALSE
      earning_percentage &lt;- (entry_price_garan - merged_data$price.y[i]) / entry_price_garan
      total_earnings &lt;- total_earnings + earning_percentage
      print(paste(&quot;Closed short position in GARAN on&quot;, merged_data$timestamp[i], &quot;with earnings:&quot;, earning_percentage))
    }
  }
  }

# Print total earnings
print(paste(&quot;Total Earnings:&quot;, total_earnings))
</code></pre>
<p class="has-line-data" data-line-start="262" data-line-end="263">Simulation results are:</p>
<p class="has-line-data" data-line-start="264" data-line-end="268">[1] “Opened long position in AKBNK on 2019-03-25 11:00:00”<br>
[1] “Opened short position in GARAN on 2019-03-25 11:00:00”<br>
[1] “Closed long position in AKBNK on 2019-03-28 11:00:00 with earnings: -0.0461180452718426”<br>
[1] “Closed short position in GARAN on 2019-03-28 11:00:00 with earnings: 0.115273373081314”</p>
<p class="has-line-data" data-line-start="269" data-line-end="270">On ‘2019-03-25 11:00:00’, a long position in AKBNK and a short position in GARAN were opened. This decision was based on signals generated by the pairs trading strategy, triggered by residuals crossing control limits.</p>
<p class="has-line-data" data-line-start="271" data-line-end="272">On ‘2019-03-28 11:00:00’, both positions were closed. The long position in AKBNK was closed with a negative earnings of approximately -4.61%. This suggests that the price of AKBNK decreased during the holding period, resulting in a loss. The short position in GARAN was closed with a positive earnings of approximately 11.53%. This indicates that the price of GARAN decreased during the holding period, resulting in a gain from the short position. A net positive return was achieved as a result of the gains from the short position in GARAN partially offsetting the losses from the long position in AKBNK. It is noteworthy, nevertheless, that the method did not completely hedge the risk, as the negative results show. The outcomes emphasize the risks and difficulties that come with pair trading. The fact that the long position in AKBNK suffered losses while the short position in GARAN was profitable shows that stock movements were not totally predictable. The findings highlight how crucial it is to manage risk well when trading in pairs. Although one position proved successful, the other’s losses underscore the inherent dangers and uncertainties associated with the financial markets.</p>
<p class="has-line-data" data-line-start="273" data-line-end="275">The output of print(paste(“Total Earnings:”, total_earnings)) gives the following:<br>
[1] “Total Earnings: 0.0691553278094716”</p>
<p class="has-line-data" data-line-start="276" data-line-end="277">The total earnings are approximately 0.069 or 6.92%. This figure represents the net gain from all executed trades during the simulation period. The earnings suggest that, collectively, the gains from profitable trades (e.g., short position in GARAN) outweighed the losses from unprofitable trades (e.g., long position in AKBNK).The positive total earnings imply that, on the whole, the pairs trading strategy generated a profit during the simulation. Interpreting this finding, though, requires taking into account the particular simulation period and conditions.</p>
<p class="has-line-data" data-line-start="278" data-line-end="279">For SASA and Sisecam stocks, the output of out of control values is as follows:</p>
<p class="has-line-data" data-line-start="280" data-line-end="339">timestamp residuals<br>
1014 2023-06-05 14.69290<br>
1015 2023-06-05 14.70158<br>
1016 2023-06-05 14.87441<br>
1017 2023-06-05 15.27168<br>
1018 2023-06-05 14.95208<br>
1019 2023-06-05 15.00915<br>
1020 2023-06-05 14.87218<br>
1021 2023-06-05 14.73521<br>
1022 2023-06-05 14.67814<br>
1023 2023-06-06 15.40097<br>
1024 2023-06-06 17.48087<br>
1025 2023-06-06 16.75531<br>
1026 2023-06-06 16.60208<br>
1027 2023-06-06 15.28471<br>
1028 2023-06-06 16.86350<br>
1029 2023-06-06 16.84067<br>
1030 2023-06-06 16.29774<br>
1031 2023-06-06 17.38632<br>
1032 2023-06-06 17.53632<br>
1033 2023-06-07 17.93075<br>
1034 2023-06-07 18.96387<br>
1035 2023-06-07 18.65680<br>
1036 2023-06-07 18.60519<br>
1037 2023-06-07 17.96660<br>
1038 2023-06-07 17.55084<br>
1039 2023-06-07 18.23509<br>
1040 2023-06-07 18.10246<br>
1041 2023-06-07 15.75841<br>
1042 2023-06-07 15.85407<br>
1043 2023-06-08 16.05519<br>
1044 2023-06-08 14.86499<br>
1045 2023-06-08 15.54216<br>
1046 2023-06-08 15.53075<br>
1047 2023-06-08 15.54216<br>
1048 2023-06-08 14.98620<br>
1049 2023-06-08 15.16883<br>
1050 2023-06-08 15.05469<br>
1051 2023-06-08 16.05630<br>
1052 2023-06-08 15.87640<br>
1053 2023-06-09 16.38236<br>
1054 2023-06-09 16.26772<br>
1055 2023-06-09 16.21338<br>
1056 2023-06-09 15.84762<br>
1057 2023-06-09 15.91610<br>
1058 2023-06-09 16.02045<br>
1059 2023-06-09 15.99762<br>
1060 2023-06-09 16.04923<br>
1061 2023-06-09 15.68782<br>
1062 2023-06-09 15.57206<br>
1063 2023-06-12 15.87367<br>
1064 2023-06-12 15.55246<br>
1065 2023-06-12 15.14812<br>
1066 2023-06-12 14.87094<br>
1067 2023-06-12 14.67367<br>
1068 2023-06-12 14.32206<br>
1069 2023-06-12 14.19055<br>
1070 2023-06-12 13.90196<br>
1071 2023-06-12 13.23459</p>
<p class="has-line-data" data-line-start="340" data-line-end="341">A low correlation suggests that there is not a significant synchronization in the price movements of the two stocks. Larger residuals in a regression model result from this lack of synchronization, particularly since the model expects a linear relationship between the two stocks.</p>
<p class="has-line-data" data-line-start="342" data-line-end="344">The X bar chart including the out of control points is as follows:<br>
<img src="part2/images/images/1.jpeg" alt="control chart2"></p>
<p class="has-line-data" data-line-start="345" data-line-end="346">The simulation results for SASA and SISE pair are as follows:</p>
<p class="has-line-data" data-line-start="347" data-line-end="351">[1] “Opened long position in SISE on 2023-06-05 11:00:00”<br>
[1] “Opened short position in SASA on 2023-06-05 11:00:00”<br>
[1] “Closed short position in SASA on 2023-06-14 11:00:00 with earnings: 0.1243072050673”<br>
[1] “Closed long position in SISE on 2023-06-14 11:00:00 with earnings: 0.0198863636363635”</p>
<p class="has-line-data" data-line-start="352" data-line-end="354">The first two lines indicate that the simulation strategy initiated a pairs trading signal on June 5, 2023. The strategy opened a long position in SISE and simultaneously opened a short position in SASA. The last two lines indicate that the simulation strategy closed the positions on June 14, 2023. The short position in SASA was closed with a positive earnings percentage, implying a profit. Simultaneously, the long position in SISE was closed with a smaller positive earnings percentage, indicating a less significant profit. The net effect of these closing actions is a positive total earning which is indicated by the following output:<br>
[1] “Total Earnings: 0.144193568703664”</p>
<p class="has-line-data" data-line-start="355" data-line-end="356">Due to the increased volatility in recent years, these stocks are more prone to price fluctuations compared to Akbank-Garanti stocks. Pairs trading strategies often benefit from price divergences and convergences between two correlated stocks. In this case, higher volatility and relatively lower correlation creates more significant price divergences, presenting additional opportunities for pairs trading strategies to capitalize on mispricing thus generating greater total earnings.</p>
<h2 class="code-line" data-line-start="357" data-line-end="358"><a id="Effectiveness_and_Limitations_357"></a>Effectiveness and Limitations</h2>
<p class="has-line-data" data-line-start="359" data-line-end="360">In order to assess the effectiveness of this approach, the first measure that can be checked is profitability since achieving positive returns is a primary goal for any trading strategy. The pairs trading technique, which is based on control chart signals and linear regression modeling, was profitable during the simulated period, as indicated by the positive total earnings. A second reason why the approach is effective is that it involves both long and short positions, potentially mitigating overall market risk. Profits from one position may offset losses from another, providing a level of risk management. Lastly, the method finds stock pairs that have a high correlation and uses linear regression modeling to analyze the link between them. Pairs trading performance is largely dependent on effective pairs selection, which the current technique appears to address by analyzing correlations.</p>
<p class="has-line-data" data-line-start="361" data-line-end="362">A major limitation of this approach is the absence of Constant Variance Assumption. The assumption of constant variance might not always hold in financial time series data and the changes in volatility over time can impact the effectiveness of the strategy. A second limitation is the transaction costs which can have significant effects on the strategy’s overall profitability, but they are not taken into account in the simulation findings. When assessing net returns in real-world circumstances, transaction expenses need to be taken into account. As a third limitation, a linear relationship between stock prices is assumed by the linear regression model. The dynamics between the paired stocks may not be well captured by the model if the underlying relationship is nonlinear.</p>
<h2 class="code-line" data-line-start="363" data-line-end="364"><a id="Task_2_363"></a>Task 2</h2>
<p class="has-line-data" data-line-start="365" data-line-end="366">The second task of the projects is based on the comparison between the first part and hence, the specified stocks according to the correlations and specified periods are exactly the same with the first part.</p>
<p class="has-line-data" data-line-start="367" data-line-end="368">In the first part of the project, pair trading strategy is built upon the linear regression model which involves constant variance assumption. Now, the new method of pair trading is developed by using time series modeling.</p>
<p class="has-line-data" data-line-start="369" data-line-end="370">Time series models offer a more sophisticated way to work with models which have trends, seasonality, autocorrelations, and are dependent on the time horizon. By defining autoregressive (AR) and moving average (MA) parts of time series models, examination of complex time related data can be accomplished without smaller biases.</p>
<p class="has-line-data" data-line-start="371" data-line-end="372"><img src="part2/images/images/3.jpeg" alt="residuals"></p>
<p class="has-line-data" data-line-start="373" data-line-end="374">Our strategy was to integrate time series models to improve trading algorithms. Therefore the input of the time series model is the residuals of the regression model of training data. Appropriate ARIMA model is defined to proceed with the residual data. Here is the ARIMA model of “AKBNK” and “GARAN”,</p>
<pre><code class="has-line-data" data-line-start="376" data-line-end="389">library(forecast)

firstHour &lt;- 24*(as.Date(&quot;2018-01-02 18:00:00&quot;)-as.Date(&quot;2018-01-02 10:00:00&quot;))
ts_residuals_training &lt;- ts(residuals_training,start=c(2018,firstHour),frequency=5*10*52)
plot(ts_residuals_training, main = &quot;Residuals over Time&quot;, ylab = &quot;Residual Value&quot;, xlab = &quot;Time&quot;)

# Use auto.arima to automatically select the best ARIMA model
auto_arima_model &lt;- auto.arima(ts_residuals_training)

# Print the summary of the selected model
summary(auto_arima_model)
tsdisplay(auto_arima_model$residuals)
</code></pre>
<p class="has-line-data" data-line-start="389" data-line-end="391">Series: ts_residuals_training<br>
ARIMA(0,1,1)</p>
<p class="has-line-data" data-line-start="392" data-line-end="396">Coefficients:<br>
ma1<br>
-0.1596<br>
s.e. 0.0201</p>
<p class="has-line-data" data-line-start="397" data-line-end="399">sigma^2 = 0.0006784: log likelihood = 5559.41<br>
AIC=-11114.83 AICc=-11114.82 BIC=-11103.18</p>
<p class="has-line-data" data-line-start="400" data-line-end="403">Training set error measures:<br>
ME RMSE MAE MPE MAPE MASE ACF1<br>
Training set -0.0002034648 0.0260364 0.01849386 222.3134 294.6888 NaN 0.002077982</p>
<p class="has-line-data" data-line-start="404" data-line-end="405">Auto.arima function is used to define a proper model. Also neighbor search of the model is implemented; however, the smallest AIC value is achieved by the ARIMA(0,1,1), which implies that model includes the first degree of differencing and the first degree of moving average part in it. In other words, training data has a linear trend in it, therefore, first differencing is applied by the model.</p>
<p class="has-line-data" data-line-start="406" data-line-end="407">Then, the residuals of the ARIMA(0,1,1) model are used to construct control charts. New control limits are constructed based on the residuals of the time series model. Time series models eliminate the trends, autocorrelations and other biases of the dataset. Therefore, the residuals of time series models are more reliable than the regression models.</p>
<p class="has-line-data" data-line-start="408" data-line-end="409">The residuals of the proposed model are plotted below. As observed in the plot, residuals have zero mean and no trend, which implies stationary data.</p>
<p class="has-line-data" data-line-start="410" data-line-end="411"><img src="part2/images/images/4.jpeg" alt="residuals"></p>
<p class="has-line-data" data-line-start="412" data-line-end="413">The process of analyzing data is relying on the testing residuals of the regression model of test data according to the new control limits. Since new control limits are more conservative than the limits in task 1, more sensitive analysis of outliers can be implemented.</p>
<pre><code class="has-line-data" data-line-start="415" data-line-end="434"># Create an X-bar chart using ggplot2
library(ggplot2)

# Calculate control limits (you can customize these based on your requirements)
upper_limit_ts &lt;- mean(auto_arima_model$residuals) + 2 * sd(auto_arima_model$residuals)
lower_limit_ts &lt;- mean(auto_arima_model$residuals) - 2 * sd(auto_arima_model$residuals)

# X-bar chart
# According to the predefined 'upper_limit' and 'lower_limit'
ggplot(residual_data, aes(x = timestamp, y = residuals)) +
  geom_point() +
  geom_line() +
  geom_hline(yintercept = upper_limit_ts, linetype = &quot;solid&quot;, color = &quot;red&quot;) +
  geom_hline(yintercept = lower_limit_ts, linetype = &quot;solid&quot;, color = &quot;red&quot;) +
  ggtitle(&quot;X-bar Chart of Residuals&quot;) +
  xlab(&quot;Date&quot;) +
  ylab(&quot;Daily Average Residuals&quot;)
  
</code></pre>
<p class="has-line-data" data-line-start="435" data-line-end="436">As stated in the plot, residuals fluctuate around the mean, while they have a pattern which is more far away from mean in Task 1. Central tendency is increased as a result of time series model. Therefore, trading simulation needs to be updated. In the Task 2, proposed simulation closes positions at the level of 0.1 sigma. The updated simulation code is provided below.</p>
<pre><code class="has-line-data" data-line-start="438" data-line-end="535"># Highlight points outside control limits
out_of_control &lt;- subset(residual_data, residuals &gt; upper_limit_ts | residuals &lt; lower_limit_ts)
print(out_of_control)

# Create a column in merged_data for residuals
merged_data$residual &lt;- residuals(regression_model)

# Signal Generation
merged_data$signal &lt;- ifelse(merged_data$residual &gt; upper_limit_ts, -1, 
                             ifelse(merged_data$residual &lt; lower_limit_ts, 1, 0))


# Initialization
long_position_akbnk&lt;- FALSE
short_position_akbnk&lt;- FALSE
long_position_garan &lt;- FALSE
short_position_garan &lt;- FALSE
total_earnings &lt;- 0
row_number &lt;- nrow(merged_data)
# Variables to store entry dates
entry_date_akbnk &lt;- NA
entry_date_garan &lt;- NA

# Loop through each timestamp
for (i in 2:nrow(merged_data)) {
  
  # Check for signal
  if (merged_data$signal[i - 1] == 1 &amp;&amp; !long_position_akbnk &amp;&amp; !short_position_akbnk) {
    # Open long position in AKBNK and short position in GARAN
    long_position_akbnk &lt;- TRUE
    short_position_garan &lt;- TRUE
    entry_price_akbnk &lt;- merged_data$price.x[i]
    entry_price_garan &lt;- merged_data$price.y[i]
    entry_date_akbnk &lt;- merged_data$timestamp[i]
    entry_date_garan &lt;- merged_data$timestamp[i]
    print(paste(&quot;Opened long position in AKBNK on&quot;, entry_date_akbnk))
    print(paste(&quot;Opened short position in GARAN on&quot;, entry_date_garan))
  } else if (merged_data$signal[i - 1] == -1 &amp;&amp; !long_position_akbnk &amp;&amp; !short_position_akbnk) {
    # Open long position in GARAN and short position in AKBNK
    long_position_garan &lt;- TRUE
    short_position_akbnk &lt;- TRUE
    entry_price_akbnk &lt;- merged_data$price.x[i]
    entry_price_garan &lt;- merged_data$price.y[i]
    entry_date_akbnk &lt;- merged_data$timestamp[i]
    entry_date_garan &lt;- merged_data$timestamp[i]
    print(paste(&quot;Opened long position in GARAN on&quot;, entry_date_garan))
    print(paste(&quot;Opened short position in AKBNK on&quot;, entry_date_akbnk))
  }
  
  if (long_position_akbnk) {
    # Close long AKBNK position if residual reverts to zero
    if (abs(merged_data$residual[i]) &lt; 0.1) {
      long_position_akbnk &lt;- FALSE
      earning_percentage &lt;- (merged_data$price.x[i] - entry_price_akbnk) / entry_price_akbnk
      total_earnings &lt;- total_earnings + earning_percentage
      print(paste(&quot;Closed long position in AKBNK on&quot;, merged_data$timestamp[i], &quot;with earnings:&quot;, earning_percentage))
    }
  }
  
  # Check for closing short AKBNK position
  if (short_position_akbnk) {
    # Close short AKBNK position if residual reverts to zero
    if (abs(merged_data$residual[i]) &lt; 0.1) {
      short_position_akbnk &lt;- FALSE
      earning_percentage &lt;- (entry_price_akbnk - merged_data$price.x[i]) / entry_price_akbnk
      total_earnings &lt;- total_earnings + earning_percentage
      print(paste(&quot;Closed short position in AKBNK on&quot;, merged_data$timestamp[i], &quot;with earnings:&quot;, earning_percentage))
    }
  }
  
  # Check for closing long GARAN position
  if (long_position_garan) {
    # Close long GARAN position if residual reverts to zero
    if (abs(merged_data$residual[i]) &lt; 0.1) {
      long_position_garan &lt;- FALSE
      earning_percentage &lt;- (merged_data$price.y[i] - entry_price_garan) / entry_price_garan
      total_earnings &lt;- total_earnings + earning_percentage
      print(paste(&quot;Closed long position in GARAN on&quot;, merged_data$timestamp[i], &quot;with earnings:&quot;, earning_percentage))
    }
  }
  
  # Check for closing short GARAN position
  if (short_position_garan) {
    # Close short GARAN position if residual reverts to zero
    if (abs(merged_data$residual[i]) &lt; 0.1) {
      short_position_garan &lt;- FALSE
      earning_percentage &lt;- (entry_price_garan - merged_data$price.y[i]) / entry_price_garan
      total_earnings &lt;- total_earnings + earning_percentage
      print(paste(&quot;Closed short position in GARAN on&quot;, merged_data$timestamp[i], &quot;with earnings:&quot;, earning_percentage))
    }
  }
}


# Print total earnings
print(paste(&quot;Total Earnings:&quot;, total_earnings))
</code></pre>
<p class="has-line-data" data-line-start="536" data-line-end="592">[1] “Opened long position in GARAN on 2019-03-05 11:00:00”<br>
[1] “Opened short position in AKBNK on 2019-03-05 11:00:00”<br>
[1] “Closed short position in AKBNK on 2019-03-07 11:00:00 with earnings: 0.0321068866204263”<br>
[1] “Closed long position in GARAN on 2019-03-07 11:00:00 with earnings: -0.0242362727137693”<br>
[1] “Opened long position in AKBNK on 2019-03-11 15:00:00”<br>
[1] “Opened short position in GARAN on 2019-03-11 15:00:00”<br>
[1] “Closed long position in AKBNK on 2019-03-12 12:00:00 with earnings: 0.00946760791234647”<br>
[1] “Closed short position in GARAN on 2019-03-12 12:00:00 with earnings: -0.00576197612526484”<br>
[1] “Opened long position in AKBNK on 2019-03-13 12:00:00”<br>
[1] “Opened short position in GARAN on 2019-03-13 12:00:00”<br>
[1] “Closed long position in AKBNK on 2019-03-15 15:00:00 with earnings: 0.0137619591603598”<br>
[1] “Closed short position in GARAN on 2019-03-15 15:00:00 with earnings: -0.0122646463131049”<br>
[1] “Opened long position in AKBNK on 2019-03-18 16:00:00”<br>
[1] “Opened short position in GARAN on 2019-03-18 16:00:00”<br>
[1] “Closed long position in AKBNK on 2019-03-18 17:00:00 with earnings: 0.00582832018268891”<br>
[1] “Closed short position in GARAN on 2019-03-18 17:00:00 with earnings: 0.002112433689757”<br>
[1] “Opened long position in AKBNK on 2019-03-19 11:00:00”<br>
[1] “Opened short position in GARAN on 2019-03-19 11:00:00”<br>
[1] “Closed long position in AKBNK on 2019-03-19 12:00:00 with earnings: 0.00293991231840456”<br>
[1] “Closed short position in GARAN on 2019-03-19 12:00:00 with earnings: 0”<br>
[1] “Opened long position in AKBNK on 2019-03-19 14:00:00”<br>
[1] “Opened short position in GARAN on 2019-03-19 14:00:00”<br>
[1] “Closed long position in AKBNK on 2019-03-19 15:00:00 with earnings: 0.00735394953373567”<br>
[1] “Closed short position in GARAN on 2019-03-19 15:00:00 with earnings: -0.00746858168761224”<br>
[1] “Opened long position in AKBNK on 2019-03-19 16:00:00”<br>
[1] “Opened short position in GARAN on 2019-03-19 16:00:00”<br>
[1] “Closed long position in AKBNK on 2019-03-28 12:00:00 with earnings: -0.154740196663201”<br>
[1] “Closed short position in GARAN on 2019-03-28 12:00:00 with earnings: 0.176665722245833”<br>
[1] “Opened long position in GARAN on 2019-03-29 14:00:00”<br>
[1] “Opened short position in AKBNK on 2019-03-29 14:00:00”<br>
[1] “Closed short position in AKBNK on 2019-03-29 17:00:00 with earnings: -0.0112592257870161”<br>
[1] “Closed long position in GARAN on 2019-03-29 17:00:00 with earnings: 0.0209704916215055”<br>
[1] “Opened long position in GARAN on 2019-04-01 11:00:00”<br>
[1] “Opened short position in AKBNK on 2019-04-01 11:00:00”<br>
[1] “Closed short position in AKBNK on 2019-04-01 12:00:00 with earnings: -0.00476208123332354”<br>
[1] “Closed long position in GARAN on 2019-04-01 12:00:00 with earnings: 0.0158932762383168”<br>
[1] “Opened long position in GARAN on 2019-04-01 16:00:00”<br>
[1] “Opened short position in AKBNK on 2019-04-01 16:00:00”<br>
[1] “Closed short position in AKBNK on 2019-04-01 17:00:00 with earnings: 0.0224666466796583”<br>
[1] “Closed long position in GARAN on 2019-04-01 17:00:00 with earnings: -0.0123342285223844”<br>
[1] “Opened long position in AKBNK on 2019-04-03 19:00:00”<br>
[1] “Opened short position in GARAN on 2019-04-03 19:00:00”<br>
[1] “Closed long position in AKBNK on 2019-04-04 13:00:00 with earnings: 0.0115961668763914”<br>
[1] “Closed short position in GARAN on 2019-04-04 13:00:00 with earnings: -0.0109670714363855”<br>
[1] “Opened long position in AKBNK on 2019-04-04 15:00:00”<br>
[1] “Opened short position in GARAN on 2019-04-04 15:00:00”<br>
[1] “Closed long position in AKBNK on 2019-04-04 18:00:00 with earnings: 0.0322337701461063”<br>
[1] “Closed short position in GARAN on 2019-04-04 18:00:00 with earnings: -0.0354720987326655”<br>
[1] “Opened long position in AKBNK on 2019-04-05 10:00:00”<br>
[1] “Opened short position in GARAN on 2019-04-05 10:00:00”<br>
[1] “Closed long position in AKBNK on 2019-04-05 11:00:00 with earnings: 0.0124554513055495”<br>
[1] “Closed short position in GARAN on 2019-04-05 11:00:00 with earnings: -0.00564519205095936”<br>
[1] “Opened long position in AKBNK on 2019-04-05 13:00:00”<br>
[1] “Opened short position in GARAN on 2019-04-05 13:00:00”<br>
[1] “Closed long position in AKBNK on 2019-04-05 15:00:00 with earnings: 0.0343827520793812”<br>
[1] “Closed short position in GARAN on 2019-04-05 15:00:00 with earnings: -0.0192805168656735”</p>
<p class="has-line-data" data-line-start="593" data-line-end="661">[1] “Opened long position in AKBNK on 2019-04-08 11:00:00”<br>
[1] “Opened short position in GARAN on 2019-04-08 11:00:00”<br>
[1] “Closed long position in AKBNK on 2019-04-08 12:00:00 with earnings: -0.00311289680385128”<br>
[1] “Closed short position in GARAN on 2019-04-08 12:00:00 with earnings: 0.00789427000177394”<br>
[1] “Opened long position in AKBNK on 2019-04-08 17:00:00”<br>
[1] “Opened short position in GARAN on 2019-04-08 17:00:00”<br>
[1] “Closed long position in AKBNK on 2019-04-12 18:00:00 with earnings: -0.0373443230093316”<br>
[1] “Closed short position in GARAN on 2019-04-12 18:00:00 with earnings: 0.0430869886204527”<br>
[1] “Opened long position in AKBNK on 2019-04-15 11:00:00”<br>
[1] “Opened short position in GARAN on 2019-04-15 11:00:00”<br>
[1] “Closed long position in AKBNK on 2019-04-16 15:00:00 with earnings: 0.0112788315130552”<br>
[1] “Closed short position in GARAN on 2019-04-16 15:00:00 with earnings: -0.00588390501319261”<br>
[1] “Opened long position in AKBNK on 2019-05-03 19:00:00”<br>
[1] “Opened short position in GARAN on 2019-05-03 19:00:00”<br>
[1] “Closed long position in AKBNK on 2019-05-06 15:00:00 with earnings: -0.0217272478819349”<br>
[1] “Closed short position in GARAN on 2019-05-06 15:00:00 with earnings: 0.029523862129916”<br>
[1] “Opened long position in AKBNK on 2019-05-06 16:00:00”<br>
[1] “Opened short position in GARAN on 2019-05-06 16:00:00”<br>
[1] “Closed long position in AKBNK on 2019-05-06 18:00:00 with earnings: 0.0119725885493446”<br>
[1] “Closed short position in GARAN on 2019-05-06 18:00:00 with earnings: -0.00753152238300752”<br>
[1] “Opened long position in GARAN on 2019-05-22 12:00:00”<br>
[1] “Opened short position in AKBNK on 2019-05-22 12:00:00”<br>
[1] “Closed short position in AKBNK on 2019-05-22 13:00:00 with earnings: 0”<br>
[1] “Closed long position in GARAN on 2019-05-22 13:00:00 with earnings: 0.00276426530769825”<br>
[1] “Opened long position in GARAN on 2019-05-22 14:00:00”<br>
[1] “Opened short position in AKBNK on 2019-05-22 14:00:00”<br>
[1] “Closed short position in AKBNK on 2019-05-22 16:00:00 with earnings: 0.0194425504659187”<br>
[1] “Closed long position in GARAN on 2019-05-22 16:00:00 with earnings: -0.0151131947443094”<br>
[1] “Opened long position in GARAN on 2019-05-23 11:00:00”<br>
[1] “Opened short position in AKBNK on 2019-05-23 11:00:00”<br>
[1] “Closed short position in AKBNK on 2019-05-23 15:00:00 with earnings: 0”<br>
[1] “Closed long position in GARAN on 2019-05-23 15:00:00 with earnings: 0.012683683810489”<br>
[1] “Opened long position in GARAN on 2019-05-24 10:00:00”<br>
[1] “Opened short position in AKBNK on 2019-05-24 10:00:00”<br>
[1] “Closed short position in AKBNK on 2019-05-24 11:00:00 with earnings: -0.0125297581756673”<br>
[1] “Closed long position in GARAN on 2019-05-24 11:00:00 with earnings: 0.0208609840263572”<br>
[1] “Opened long position in GARAN on 2019-05-28 13:00:00”<br>
[1] “Opened short position in AKBNK on 2019-05-28 13:00:00”<br>
[1] “Closed short position in AKBNK on 2019-05-28 15:00:00 with earnings: -0.00340388042368307”<br>
[1] “Closed long position in GARAN on 2019-05-28 15:00:00 with earnings: 0.00794063852250589”<br>
[1] “Opened long position in GARAN on 2019-06-10 12:00:00”<br>
[1] “Opened short position in AKBNK on 2019-06-10 12:00:00”<br>
[1] “Closed short position in AKBNK on 2019-06-13 13:00:00 with earnings: 0.0345625080303225”<br>
[1] “Closed long position in GARAN on 2019-06-13 13:00:00 with earnings: -0.0348964455072347”<br>
[1] “Opened long position in GARAN on 2019-06-13 15:00:00”<br>
[1] “Opened short position in AKBNK on 2019-06-13 15:00:00”<br>
[1] “Closed short position in AKBNK on 2019-06-14 11:00:00 with earnings: 0”<br>
[1] “Closed long position in GARAN on 2019-06-14 11:00:00 with earnings: 0.002521481898859”<br>
[1] “Opened long position in GARAN on 2019-06-14 17:00:00”<br>
[1] “Opened short position in AKBNK on 2019-06-14 17:00:00”<br>
[1] “Closed short position in AKBNK on 2019-06-17 11:00:00 with earnings: -0.0165908430936018”<br>
[1] “Closed long position in GARAN on 2019-06-17 11:00:00 with earnings: 0.0229255456079631”<br>
[1] “Opened long position in GARAN on 2019-06-17 19:00:00”<br>
[1] “Opened short position in AKBNK on 2019-06-17 19:00:00”<br>
[1] “Closed short position in AKBNK on 2019-06-18 11:00:00 with earnings: -0.00322290511167739”<br>
[1] “Closed long position in GARAN on 2019-06-18 11:00:00 with earnings: 0.00491776179849566”<br>
[1] “Opened long position in GARAN on 2019-06-18 13:00:00”<br>
[1] “Opened short position in AKBNK on 2019-06-18 13:00:00”<br>
[1] “Closed short position in AKBNK on 2019-06-18 15:00:00 with earnings: 0”<br>
[1] “Closed long position in GARAN on 2019-06-18 15:00:00 with earnings: 0.00241542634299054”<br>
[1] “Opened long position in GARAN on 2019-06-18 16:00:00”<br>
[1] “Opened short position in AKBNK on 2019-06-18 16:00:00”<br>
[1] “Closed short position in AKBNK on 2019-06-26 17:00:00 with earnings: -0.056855693868142”<br>
[1] “Closed long position in GARAN on 2019-06-26 17:00:00 with earnings: 0.0724600344402111”<br>
[1] “Opened long position in GARAN on 2019-06-26 19:00:00”<br>
[1] “Opened short position in AKBNK on 2019-06-26 19:00:00”<br>
[1] “Closed short position in AKBNK on 2019-06-27 11:00:00 with earnings: -0.00892888163151863”<br>
[1] “Closed long position in GARAN on 2019-06-27 11:00:00 with earnings: 0.0112521310854329”</p>
<p class="has-line-data" data-line-start="662" data-line-end="663">As observed in the AKBNK and GARAN positions above, control chart construction with the help of time series model is pretty sensitive to the change in the pair prices. Therefore, the number of the long-short positions increased. More opportunities are available to trade.</p>
<p class="has-line-data" data-line-start="664" data-line-end="665">[1] “Total Earnings: 0.307945941720126”</p>
<p class="has-line-data" data-line-start="666" data-line-end="667">Total earnings of pair trading in that method is %30.7, while in Task 1 %6.92 . Even though the trading is implemented in the same period to the same pair of stocks, total earnings in the specified period is considerably higher than Task 1.</p>
<p class="has-line-data" data-line-start="669" data-line-end="670">The residuals of the SASA - SISE are plotted in the below diagram. The same method implemented the pair trade of SASA - SISE in same period.</p>
<p class="has-line-data" data-line-start="671" data-line-end="672"><img src="part2/images/images/5.jpeg" alt="residuals"></p>
<p class="has-line-data" data-line-start="673" data-line-end="675">Series: ts_residuals_training<br>
ARIMA(1,1,1)</p>
<p class="has-line-data" data-line-start="676" data-line-end="680">Coefficients:<br>
ar1 ma1<br>
0.5442 -0.5955<br>
s.e. 0.1144 0.1088</p>
<p class="has-line-data" data-line-start="681" data-line-end="683">sigma^2 = 0.4031: log likelihood = -2415.52<br>
AIC=4837.04 AICc=4837.05 BIC=4854.52</p>
<p class="has-line-data" data-line-start="684" data-line-end="687">Training set error measures:<br>
ME RMSE MAE MPE MAPE MASE ACF1<br>
Training set -0.007210093 0.634537 0.2794884 -1.387574 15.82548 NaN 0.01094218</p>
<p class="has-line-data" data-line-start="688" data-line-end="689">The auto.arima function is used to determine the proper model for modeling residuals of SASA - SISE pair. The method provides ARIMA(1,1,1) with the AIC value 4837.04, which is reasonable for the model. Model suggests an autoregressive part, a moving average part and first differencing in data to eliminate trends and other biases. Namely, residuals of the SASA-SISE regression model has linear trend in it.</p>
<p class="has-line-data" data-line-start="690" data-line-end="691">The residuals of the ARIMA(1,1,1) model of residuals are plotted as in the below diagram. It is apparent that the residuals have mean zero and no trends, in other words it is stationary data. Strict changes at the end of the training data period are observed because of the uncommon price fluctuations in the BIST at that period.</p>
<p class="has-line-data" data-line-start="692" data-line-end="693"><img src="part2/images/images/6.jpeg" alt="residuals"></p>
<p class="has-line-data" data-line-start="694" data-line-end="716">[1] “Opened long position in SASA on 2023-01-02 12:00:00”<br>
[1] “Opened short position in SISE on 2023-01-02 12:00:00”<br>
[1] “Closed long position in SASA on 2023-02-02 19:00:00 with earnings: -0.0155813875045325”<br>
[1] “Closed short position in SISE on 2023-02-02 19:00:00 with earnings: 0.11219936092982”<br>
[1] “Opened long position in SASA on 2023-02-03 12:00:00”<br>
[1] “Opened short position in SISE on 2023-02-03 12:00:00”<br>
[1] “Closed long position in SASA on 2023-02-20 18:00:00 with earnings: 0.101407209682017”<br>
[1] “Closed short position in SISE on 2023-02-20 18:00:00 with earnings: -0.140115458064138”<br>
[1] “Opened long position in SASA on 2023-02-21 13:00:00”<br>
[1] “Opened short position in SISE on 2023-02-21 13:00:00”<br>
[1] “Closed long position in SASA on 2023-03-13 13:00:00 with earnings: 0.0235619957451933”<br>
[1] “Closed short position in SISE on 2023-03-13 13:00:00 with earnings: 0.0314790302571892”<br>
[1] “Opened long position in SISE on 2023-03-13 19:00:00”<br>
[1] “Opened short position in SASA on 2023-03-13 19:00:00”<br>
[1] “Closed short position in SASA on 2023-03-16 16:00:00 with earnings: 0.0285481995882788”<br>
[1] “Closed long position in SISE on 2023-03-16 16:00:00 with earnings: 0.00173013803731569”<br>
[1] “Opened long position in SASA on 2023-03-17 17:00:00”<br>
[1] “Opened short position in SISE on 2023-03-17 17:00:00”<br>
[1] “Closed long position in SASA on 2023-05-22 12:00:00 with earnings: -0.0806038258602074”<br>
[1] “Closed short position in SISE on 2023-05-22 12:00:00 with earnings: 0.204556723143357”<br>
[1] “Opened long position in SISE on 2023-05-23 12:00:00”<br>
[1] “Opened short position in SASA on 2023-05-23 12:00:00”</p>
<p class="has-line-data" data-line-start="717" data-line-end="718">Above, the positions as a result of outliers in the control chart are indicated. Number of the positions are higher than Task 1. Again the high sensitivity of the control chart constructed according to time series residuals are causes of that increase.</p>
<p class="has-line-data" data-line-start="719" data-line-end="720">[1] “Total Earnings: 0.267181985954293”</p>
<p class="has-line-data" data-line-start="721" data-line-end="722">Total earnings of pair trading in that method is %26.7, while in Task 1 %14.4 . Even though the trading is implemented in the same period to the same pair of stocks, total earnings in the specified period is considerably higher than Task 1.</p>
<h2 class="code-line" data-line-start="723" data-line-end="724"><a id="Key_Findings_and_Insights_723"></a>Key Findings and Insights</h2>
<ul>
<li class="has-line-data" data-line-start="725" data-line-end="727">
<p class="has-line-data" data-line-start="725" data-line-end="726">The pairs trading strategy focuses on capturing favorable opportunities, making profits by opening long-short positions when relative price opportunities arise, instead of simply holding a stock. The strategy involves dynamic decision-making regarding positions. Instead of adopting a static “buy and hold” approach, it adapts to relative price movements. Opening long and short positions indicates a more sophisticated strategy that takes advantage of both upward and downward price movements. The use of long-short positions implies a built-in risk management aspect. By simultaneously holding both long and short positions, the strategy aims to hedge against overall market movements, focusing on the relative performance of the selected assets.</p>
</li>
<li class="has-line-data" data-line-start="727" data-line-end="729">
<p class="has-line-data" data-line-start="727" data-line-end="728">Strategies implemented on short-term test data involve holding positions for relatively brief periods, while long-term strategies are more attractive and yield more profitable results by capturing opportunities over extended time frames. Short-term data could be more prone to market noise, which is the influence of random events and short-term variations on price movements. As a result of this, short-term data-driven strategies could be more volatile and have less predictable trends. Long-term data allows for the identification of statistically significant patterns and relationships. Strategies built on robust statistical evidence tend to perform more consistently over time</p>
</li>
<li class="has-line-data" data-line-start="729" data-line-end="731">
<p class="has-line-data" data-line-start="729" data-line-end="730">In Task 1, we had built a model based on the residuals of the regression model, which encompassed variance changes. In the time series model, we eliminated time-dependent variables, resulting in a more stationary dataset. This stationary data enabled us to identify outliers in a cleaner manner. A more stationary dataset allowing for cleaner outlier detection suggests a focus on identifying and managing unusual or extreme events in the data. Outlier detection is crucial in refining trading strategies to avoid misleading signals or abnormal market conditions. Our profit in Garanti-Akbank increased by 3.43 times, and in Sasa-Sise, it rose to 0.85 times.</p>
</li>
<li class="has-line-data" data-line-start="731" data-line-end="733">
<p class="has-line-data" data-line-start="731" data-line-end="732">We couldn’t use the same simulation for the newly designed model in task 2, we had to update our simulation based on the movements of the patterns because different models exhibit different behaviors.</p>
</li>
<li class="has-line-data" data-line-start="733" data-line-end="735">
<p class="has-line-data" data-line-start="733" data-line-end="734">In the context of pair trading, where two assets are traded simultaneously, having excessive covariance between the assets acted as a hindrance to the effectiveness of the trading strategy. Covariance measures the degree to which two variables (in this case, the prices or returns of the two assets in a pair) move together. High covariance indicates that the assets tend to move in the same direction, and this can limit the diversification benefits that pair trading aims to exploit. Pair trading often relies on identifying pairs of assets with historically high correlation or covariance but with the expectation that the relationship will revert to the mean. If the covariance is too high, it may indicate a persistent and strong directional movement between the assets, making it challenging for the pair trading strategy to capitalize on mean-reverting behavior.Lower covariances may provide more room for the assets to deviate from each other, increasing the likelihood of mean-reverting behavior and creating opportunities for profitable trades. In essence, a moderate or lower covariance allows for more flexibility in capturing potential divergences and convergences between the prices of the paired assets, which is fundamental to the success of pair trading strategies.</p>
</li>
<li class="has-line-data" data-line-start="735" data-line-end="736">
<p class="has-line-data" data-line-start="735" data-line-end="736">Fluctuations in BIST stocks, especially the significant price changes in the years 2022-2023, posed challenges to the smooth functioning of models. In particular, the time series model yielded better profits in more predictable and foreseeable environments. Task 2, especially during the predictable period of Garanti-Akbank, successfully reflected the increase in profits, while Sasa-Sise did not show a similar increase.</p>
</li>
</ul>
</body></html>